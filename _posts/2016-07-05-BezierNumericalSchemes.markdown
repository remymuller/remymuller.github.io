---
author: remy
comments: false
layout: post
slug: bezier-Nnumerical-schemes
title: Numerical schemes generated by Bezier splines
categories:
- science
---

We consider ordinary differential equations of the form

$$
	\mathbf{\dot y(t)} = f(\mathbf{y},t) = \mathbf{A y(t)}
$$

We will show how the bezier splines lead naturally to well known numerical integration schemes while giving a meaningful interpretation to their intermediate control points. 

In the following, to simplify notation, each time step is normalised to $$[0,1]$$ thus the $$A$$ matrix is supposed to be pre-normalised by the stepsize $$h$$


We will first study the well-known Linear, Quadratic and Cubic bezier splines and the respective numerical schemes that they can generate.

# Linear Bezier spline

The linear bezier spline is defined for $$t \in [0,1]$$ and the control points $$\mathbf{P_0, P_1} \in \mathbb{R}^n$$ as

$$
\begin{align}
	\mathbf{B(t)} &= \mathbf{P_0}(1-t) + \mathbf{P_1} t \\
	\label{LinearBezierDerivative}
	\mathbf{\dot B(t)} &= \mathbf{P_1 - P_0} 
\end{align}	
$$

where $$\mathbf{P_0, P_1}$$ are the end-points of the curve.

By evaluating The above equations for $$t=\{0, \frac{1}{2}, 1\}$$ we get the following relations:

$$
	\begin{align} 
		\mathbf{P_1 - P_0} &= A \mathbf{P_0} \\
		\mathbf{P_1 - P_0} &= A \left(\frac{\mathbf{P_1 + P_0}}{2}\right) \\
		\mathbf{P_1 - P_0} &= A \mathbf{P_1} 
	\end{align}
$$

By combining these equations, we can generate several different approximations that we will label $$(m,n)$$ according to the fact that we use order $$m$$ forward prediction and order $$n$$ backward prediction.

## Forward Euler (1,0)

Using the first relation and solving for $$P_1$$ leads to the following forward prediction:

$$
	\begin{equation}
		\mathbf{P_1} = (I+A) \mathbf{P_0}
	\end{equation}
$$

with stability region 

$$
	\begin{align}
		R(z) = 1+z
	\end{align}
$$

Remark: this is the Pade (1,0) approximation of $$e^z$$

## Mid-point 

Using the second relation and solving for $$P_1$$ leads to the following prediction:

$$
	\begin{align}
		\mathbf{P_1} = \left(I-\frac{A}{2}\right)^{-1} \left(I+\frac{A}{2}\right) \mathbf{P_0}
	\end{align}
$$

with stability region 

$$
	\begin{align}
		R(z) = \frac{1+\frac{z}{2}}{1-\frac{z}{2}}
	\end{align}
$$

Remark: This is the Pade (1,1) approximation of $$e^z$$. The symmetry of the collocation point within the interval allows to reach a consistency of order 2 while the polynomial is only of degree 1.	

## Backward Euler (0,1)

Using The third equation and solving for $$P_1$$ leads to the following prediction:

$$
	\begin{align}
		\mathbf{P_1} = (I-A)^{-1} \mathbf{P_0}
	\end{align}
$$

with stability region 

$$
	\begin{align}
		R(z) = \frac{1}{1-z}
	\end{align}
$$

Remark: This is the Pade (0,1) approximation of $$e^z$$


# Quadratic Bezier Spline

The quadratic bezier spline is defined for $$t \in [0,1]$$ and the control points $$\mathbf{P_0, P_1, P_2} \in \mathbb{R}^n$$ as

$$
	\begin{align}
		\mathbf{B(t)} &= \mathbf{P_0}(1-t)^2 + \mathbf{P_1} 2(1-t)t + \mathbf{P_2} t^2 \\
		\label{QuadraticBezierDerivative}
		\mathbf{\dot B(t)} &= 2(1-t)\mathbf{(P_1 - P_0)} + 2t \mathbf{(P_2 - P_1)} \\
		\label{QuadraticBezierSecondDerivative} 
		\mathbf{\ddot B(t)} &= 2\mathbf{(P_2 - 2P_1 + P_0)}
	\end{align}	
$$

where $$\mathbf{P_0, P_2}$$ are the end-points of the curve and $$\mathbf{P_1}$$ is a control point not belonging to the curve but having an effect on its derivative.

